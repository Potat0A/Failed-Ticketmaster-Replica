{% extends "base.html" %}

{% block title %}Tickets{% endblock %}

{% block content %}
<h1>All Concert Tickets</h1>

<!-- Display all tickets -->
<form method="POST">
     <input type="text" id="searchinput" name="searchinput" required>
     <button type="submit">Search</button>
    </form>
<div class="ticket-list" style="margin-left:100px;">
    {% for ticket in tickets %}
        <div class="ticket-card">
            {% if ticket.image_path %}
                <!-- Display the poster image -->
                <img src="{{ ticket.image_path }}"
                     alt="Poster for {{ ticket.name }}"
                     class="ticket-image"
                     style="width: 200px; height: auto;">
            {% else %}
                <!-- Fallback message if no image is provided -->
                <p>No Poster Available</p>
            {% endif %}

            <h2>{{ ticket.name }}</h2>

            <!-- Display event description as non-editable -->
            {% set event = event_dict[ticket.event_id] if ticket.event_id in event_dict else None %}
            {% if event %}
                <p><strong>Description:</strong> {{ event.event_desc }}</p> <!-- Display Description -->
                <p><strong>Artist:</strong> {{ event.artist }}</p>
                <p><strong>Genre:</strong> {{ event.genre }}</p> <!-- Display Genre -->
            {% else %}
                <p><strong>Description:</strong> Event not found</p>
                <p><strong>Artist:</strong> Event not found</p>
                <p><strong>Genre:</strong> Event not found</p>
            {% endif %}

            <p><strong>Price:</strong> ${{ ticket.price }}</p>

            <p><strong>Seat Information:</strong>
                Row: {{ ticket.seat_row }},
                Number: {{ ticket.seat_number }},
                Section: {{ ticket.seat_section }}
            </p>
            <p><strong>Type:</strong> {{ ticket.type }}</p>
            <a href="{{ url_for('edit_ticket', ticket_id=ticket.ticket_id) }}">Edit</a>
            <form action="{{ url_for('delete_ticket', ticket_id=ticket.ticket_id) }}" method="POST" style="display:inline;">
                <button type="submit">Delete</button>
            </form>
        </div>
    {% else %}
        <p>No tickets available.</p>
    {% endfor %}
</div>

<a href="{{ url_for('add_ticket') }}" style="margin-left:100px;">Add New Ticket</a>
<a href="{{ url_for('tickets') }}" style="margin-left:100px;">View All Tickets</a>
{% endblock %}
